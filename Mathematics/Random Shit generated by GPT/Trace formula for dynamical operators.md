
## Tags
#trace-formula #dynamical-system 

---

## References:


---
## Other related notes:
[[Snapshot for dynamical system]]
[[Notes for traces formula]]
[[Snapshots of Number theory]]
[[Some new ideas for homogenus dynamical sytem and trace formula]]

---

## Main idea
Taking ergodic average function, geodesic flow, horocycle flow, or any other dynamical interesting operator as operators, then unfold the information using the philosophy of trace formula.

Yes, we can develop the trace formula for the horocycle flow as an operator on the manifold. Let us consider the Laplace-Beltrami operator on a compact hyperbolic surface.

The Laplace-Beltrami operator on a hyperbolic surface is given by:

$\Delta_Y = -\frac{1}{\sqrt{g}}\partial_i (\sqrt{g}g^{ij}\partial_j)$

Where $g$ is the metric of the surface, $g^{ij}$ is the inverse of the metric and $\partial_i$ is the partial derivative with respect to the $i$-th coordinate.

The eigenvalues and eigenfunctions of the Laplace-Beltrami operator can be used to construct the trace formula. Specifically, one can show that the trace of the heat kernel of the Laplace-Beltrami operator can be expressed in terms of the eigenvalues and eigenfunctions. The heat kernel is given by:

$K_t(x,y) = \sum_{n=1}^\infty e^{-\lambda_n t} \phi_n(x) \phi_n(y)$

Where $x$ and $y$ are points on the surface, $\lambda_n$ are the eigenvalues of the Laplace-Beltrami operator, and $\phi_n(x)$ and $\phi_n(y)$ are the corresponding eigenfunctions.

Now, we can consider the horocycle flow as an operator on the surface. For any point $x$ on the surface, we can define a flow map $\Phi_t(x)$ that takes $x$ to the point $\Phi_t(x)$ after time $t$ under the horocycle flow. This flow map is generated by the horocycle vector field as described earlier.

Using this flow map, we can define an operator $U_t$ on the eigenfunctions of the Laplace-Beltrami operator as follows:

$U_t \phi_n(x) = \phi_n(\Phi_t(x))$

The operator $U_t$ takes an eigenfunction $\phi_n(x)$ and maps it to the same eigenfunction evaluated at the point $\Phi_t(x)$.

Using this operator, we can express the heat kernel under the horocycle flow as:

$K_t^H(x,y) = \sum_{n=1}^\infty e^{-\lambda_n t} \phi_n(x) U_t \phi_n(y)$

The trace formula for the horocycle flow can then be expressed in terms of the heat kernel under the flow as:

$Tr(U_t) = \int_M K_t^H(x,x) d\mu(x)$

Where $M$ is the hyperbolic surface, $\mu$ is the hyperbolic measure on $M$, and $Tr(U_t)$ is the trace of the operator $U_t$.

This formula relates the trace of the operator $U_t$ to the heat kernel under the horocycle flow, which can be expressed in terms of the eigenvalues and eigenfunctions of the Laplace-Beltrami operator on the surface. The trace formula has many applications in hyperbolic geometry, number theory, and quantum mechanics.

### Justify the idea that horocycle flow as operator

The horocycle flow operator is defined on the space of square-integrable functions on a hyperbolic surface. Let us assume that we are working with a compact hyperbolic surface $\mathcal{M}$ of genus $g\geq 2$, and let $\Delta_\mathcal{M}$ be the Laplace-Beltrami operator on $\mathcal{M}$.

Recall that the horocycle flow is a one-parameter family of isometries of $\mathcal{M}$ that preserves the hyperbolic metric. More precisely, for every $t\in\mathbb{R}$, there is a diffeomorphism $\Phi_t:\mathcal{M} \longrightarrow \mathcal{M}$ associated to the flow, such that $\Phi_t(p)$ is the point obtained by traveling distance $t$ in the direction of the horocycle based at $p$.

Using this flow map, we can define the horocycle flow operator $U_t$ as a linear operator acting on the space of square-integrable functions on $\mathcal{M}$. Specifically, for any $f\in L^2(\mathcal{M})$ and $t\in\mathbb{R}$, we have:

$$ U_t(f)(p) = f(\Phi_t(p)), \quad \forall p\in \mathcal{M} $$

Now, we can ask about the eigenfunctions and eigenvalues of the horocycle flow operator. An eigenvector for $U_t$ is a non-zero function $\varphi \in L^2(\mathcal{M})$ such that $U_t(\varphi) = \lambda \varphi$ for some $\lambda \in \mathbb{C}$.

To determine the eigenfunctions and eigenvalues for the horocycle flow operator, it is natural to consider the Fourier decomposition of $L^2(\mathcal{M})$ with respect to the Laplace-Beltrami operator $\Delta_\mathcal{M}$.

Recall that the Laplace-Beltrami operator $\Delta_\mathcal{M}$ has a discrete spectrum of eigenvalues $\lambda_n$ that form a non-decreasing sequence tending to infinity. The eigenfunctions $\varphi_n \in L^2(\mathcal{M})$ of $\Delta_\mathcal{M}$ form an orthonormal basis for $L^2(\mathcal{M})$.

Now, we can use this basis to study the eigenvectors of $U_t$. Specifically, we can write any $f\in L^2(\mathcal{M})$ as a Fourier series:

$$ f = \sum_{n=1}^\infty a_n \varphi_n $$

where the coefficients $a_n$ are given by:

$$ a_n = \langle f, \varphi_n \rangle_{L^2} $$

Using this expansion, we can compute the action of the horocycle flow operator on $f\in L^2(\mathcal{M})$:

$$ U_t(f) = \sum_{n=1}^\infty a_n U_t(\varphi_n) = \sum_{n=1}^\infty a_n e^{-t\lambda_n} \varphi_n $$

So, we see that if $\varphi_n$ is an eigenfunction of $U_t$, then it must satisfy $U_t(\varphi_n) = e^{-t\lambda_n} \varphi_n$ for some eigenvalue $e^{-t\lambda_n}$. Thus, we have found that the eigenfunctions of the horocycle flow operator are the same as the eigenfunctions of the Laplace-Beltrami operator, and the corresponding eigenvalues are given by $e^{-t\lambda_n}$.

In summary, the eigenfunctions of the horocycle flow operator on a compact hyperbolic surface are given by the eigenfunctions of the Laplace-Beltrami operator, and the corresponding eigenvalues are $e^{-t\lambda_n}$, where $\lambda_n$ are the eigenvalues of the Laplace-Beltrami operator.

### then does the eigenfunction of horocycle operator form a basis of $L^{2}(M)$

Yes, the eigenfunctions of the horocycle flow operator form a basis for $L^2(\mathcal{M})$, which is the space of square-integrable functions on a compact hyperbolic surface $\mathcal{M}$.

Recall that the Laplace-Beltrami operator $\Delta_\mathcal{M}$ on $\mathcal{M}$ has a discrete spectrum of eigenvalues $\lambda_n$ with finite multiplicity. The eigenfunctions $\varphi_n$ corresponding to these eigenvalues form an orthonormal basis for $L^2(\mathcal{M})$.

Using the Fourier decomposition of $L^2(\mathcal{M})$ with respect to the Laplace-Beltrami operator, we found that the eigenfunctions of the horocycle flow operator are given by $U_t(\varphi_n) = e^{-t\lambda_n}\varphi_n$. This means that the eigenfunctions of the horocycle flow operator are also eigenfunctions of the Laplace-Beltrami operator, and they form another orthonormal basis for $L^2(\mathcal{M})$.

Since the eigenfunctions of both the Laplace-Beltrami operator and the horocycle flow operator form orthonormal bases for $L^2(\mathcal{M})$, any square-integrable function on $\mathcal{M}$ can be expressed as a linear combination of these eigenfunctions. Therefore, the eigenfunctions of the horocycle flow operator form a basis for $L^2(\mathcal{M})$.


### Based on new information about horocycle flow operator, can you find a integral operator that commutes with horocycle flow operator?

To find an integral operator that commutes with the horocycle flow operator, we can start by considering convolution operators on the hyperbolic surface.

Let $K_t(x,y)$ be the heat kernel on the hyperbolic surface, which satisfies the heat equation $\frac{\partial K_t}{\partial t} = \Delta_K K_t$, where $\Delta_K$ is the Laplace-Beltrami operator on the hyperbolic surface and $K_0$ is the Dirac delta function at a fixed point $p_0 \in \mathcal{M}$. We will assume that the hyperbolic surface is compact without boundary.

Given any function $f \in L^2(\mathcal{M})$, we can convolve it with the heat kernel $K_t$ to obtain a new function $F_t(x)$ defined by:

$$ F_t(x) = \int_{\mathcal{M}} K_t(x,y) f(y) d\mu(y) $$

where $d\mu(y)$ is the hyperbolic area measure on $\mathcal{M}$.

This defines a continuous family of integral operators (trace class) $T_t$ on $L^2(\mathcal{M})$ given by:

$$ T_t(f)(x) = \int_{\mathcal{M}} K_t(x,y) f(y) d\mu(y)=F_{t}(x)$$

Now, to check whether $T_t$ commutes with the horocycle flow operator at each time $t$, we need to show that:

$$ U_t(T_t(f)) = T_t(U_t(f)) $$

for all $f \in L^2(\mathcal{M})$.

To do this, we can use the fact that the heat kernel satisfies the semigroup property $K_{t+s}(x,y) = \int_{\mathcal{M}} K_t(x,z)K_s(z,y) d\mu(z)$ for all $x,y \in \mathcal{M}$ and $t,s \geq 0$. Using this property, we can write:

$$\begin{align*}  
U_t(T_t(f))(x) &= U_t\Big(\int_{\mathcal{M}} K_t(x,y) f(y) d\mu(y)\Big) \\  
&= \int_{\mathcal{M}} K_t(x,y) f(\Phi_t^{-1}(y)) d\mu(y) \\  
&= \int_{\mathcal{M}} K_s(x,\Phi_t(z)) f(z) d\mu(z) \qquad \text{(using the change of variables $y = \Phi_t(z)$)} \\  
&= T_s(U_t(f))(x) \\  
&= (T_s \circ U_t)(f)(x)  
\end{align*}$$

where we have used the fact that the horocycle flow $\Phi_t$ commutes with convolution under the heat kernel, i.e. $K_t(x,y) = K_t(\Phi_t(x),\Phi_t(y))$ for all $x,y \in \mathcal{M}$ and $t \geq 0$.

Therefore, we have shown that the integral operator $T_t$ commutes with the horocycle flow operator $U_t$, for all $t \geq 0$. 

