

## Tags
 #trace-formula #dynamical-system 

---

## References:


---
## Other related notes:
[[Trace formula for dynamical operators]]
[[Notes for traces formula]]
[[Snapshots of Number theory]]

---

## Horocycle flow

Horocycle flow on the upper half plane is a flow generated by the action of a certain group of matrices on the upper half plane. The matrices in question are called unipotent upper-triangular matrices, and they form a group called the horocyclic group.

The flow takes a point in the upper half plane and moves it along a curve called a horocycle, which is a circle whose center is on the real axis, but may lie at infinity. The horocycle is tangent to the imaginary axis at the point being moved and is perpendicular to all vertical lines in the upper half plane.

## How to interpret this horocycle flow as a operator

The horocycle flow on the upper half plane can be interpreted as a linear operator on a certain space of functions. Let $\mathcal{H}$ be the space of holomorphic functions on the upper half plane that vanish at infinity, and let $M$ be the modular group, which consists of 2x2 matrices with integer coefficients and determinant 1.

Then, for each $\gamma\in M$, we can define a linear operator $U_\gamma : \mathcal{H} \rightarrow \mathcal{H}$ by setting

$$(U_\gamma f)(z) = f(\gamma z)$$

In other words, $U_\gamma$ takes a function $f$ defined on the upper half plane and moves it along the horocycle determined by $\gamma$, mapping it to a function defined at a point $\gamma z$.

It can be shown that $U_\gamma$ is a unitary operator with respect to a certain inner product on $\mathcal{H}$, which is related to the Poincaré metric on the upper half plane. The horocycle flow is then generated by the one-parameter subgroup of $M$ consisting of matrices of the form

$$\begin{pmatrix} 1 & t \\ 0 & 1 \end{pmatrix}$$

where $t\in\mathbb{R}$. The corresponding operators $U_t$ satisfy

$$ U_t U_s = U_{t+s}, $$

which means that the horocycle flow is a strongly continuous group of unitary operators on the Hilbert space $\mathcal{H}$.

## How to write down the trace formula of horocycle flow?

The trace formula for the horocycle flow on the upper half plane expresses the spectral decomposition of the Laplacian operator in terms of the orbits of the flow. It is a powerful tool in the study of automorphic forms and has important applications in number theory.

The trace formula for the horocycle flow can be written as follows:

$$\sum_{\gamma\in M\backslash\{1\}} \int_{\Gamma_\gamma\backslash\mathbb{H}} f(z) d\mu_\gamma(z) = \sum_{j=1}^\infty m_j \cdot \mathrm{Tr}(f|_{\mathcal{H}_j})$$

Here, $M$ is the modular group, $\Gamma_\gamma$ is the stabilizer of $\gamma$ under $M$, $\mathbb{H}$ is the upper half plane, $f$ is a function in the space of automorphic forms, $\mu_\gamma$ is the invariant measure on the horocycle determined by $\gamma$, $\mathcal{H}_j$ is the space of holomorphic cusp forms of weight $k_j$ and $m_j$ is the multiplicity of the eigenvalue $k_j^2/4$ of the Laplacian operator on $\mathcal{H}_j$.

The left-hand side of the  sums over the eigenspaces of the Laplacian operator. The trace formula thus expresses a profound relationship between the spectral properties of the Laplacian and the geometry of the horocycles.

## How to get the spectral side of this trace formula

To obtain the spectral side of the trace formula for the horocycle flow on the upper half plane, we need to compute the eigenvalues and eigenfunctions of the Laplacian operator on the space of automorphic forms.

The Laplacian operator on the upper half plane acts on a function $f(z)$ as follows:

$$\Delta f(z) = -y^2 \left( \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} \right) f(z)$$

where $z=x+iy$ and $x, y\in\mathbb{R}$. The Laplacian is a self-adjoint operator on $L^2(\mathbb{H}, dxdy/y^2)$, the space of square-integrable functions on the upper half plane.

The Laplacian has a discrete spectrum consisting of eigenvalues $k_j^2/4$, where $k_j$ is a non-negative integer. The eigenspace corresponding to each eigenvalue $k_j^2/4$ is the space of holomorphic cusp forms of weight $k_j$, denoted by $\mathcal{H}_j$. The dimension of $\mathcal{H}_j$ can be computed using the Riemann-Roch theorem and is given by

$$\dim \mathcal{H}_j = \begin{cases} \lfloor j/12\rfloor &\text{if } j\equiv 2\pmod{12}\\ \lfloor (j-1)/12\rfloor &\text{if } j\equiv 0, 6, 8, 10\pmod{12} \end{cases}$$

The eigenfunctions of the Laplacian on $\mathcal{H}_j$ are given by the normalized Eisenstein series

$$E(z,s) = \sum_{(m,n)\in\mathbb{Z}^2\backslash(0,0)} \frac{y^s}{\lvert mz+n\rvert^{2s}}$$

where $s$ is a complex number such that $\mathrm{Re}(s)>1$. These functions are automorphic and satisfy $\Delta E(z,s) = s(1-s)E(z,s)$.

In the spectral side of the trace formula, we sum over the eigenvalues $k_j^2/4$ and the corresponding eigenspaces $\mathcal{H}_j$. The multiplicity $m_j$ of the eigenvalue $k_j^2/4$ is given by

$$m_j = \dim \mathcal{H}_j - \dim S_k$$

where $S_k$ is the space of holomorphic modular forms of weight $k$.

Therefore, the spectral side of the trace formula is given by

$$\sum_{j=1}^\infty m_j \cdot \mathrm{Tr}(f|_{\mathcal{H}_j}) = \sum_{j=1}^\infty ( \dim \mathcal{H}_j - \dim S_k ) \cdot \sum_{\phi\in\mathcal{H}_j} \int_{\mathbb{H}} f(z)\phi(z) \frac{dx dy}{y^2} $$

where $\mathrm{Tr}(f|_{\mathcal{H}_j})$ denotes the trace of the restriction of $f$ to the subspace $\mathcal{H}_j$ and the integral on the right-hand side is over the upper half plane. Note that the sum on the right-hand side is over a orthonormal basis of $\mathcal{H}_j$ with respect to the inner product $\langle f,g\rangle = \int_{\mathbb{H}} f(z)\overline{g(z)} (dx dy)/y^2$.

## How to get the geometric side of this trace formula, and what is the meaning of that side?

To obtain the geometric side of the trace formula for the horocycle flow on the upper half plane, we need to compute the contribution of the horocyclic orbits to the trace.

Let $\mu_\gamma$ be the measure on the horocycle determined by the non-trivial element $\gamma\in M$ of the modular group $M$. The measure $\mu_\gamma$ is invariant under the action of the horocycle flow generated by $\gamma$. The contribution of the horocycle orbit to the trace is given by

$$\int_{\Gamma_\gamma\backslash\mathbb{H}} f(z) d\mu_\gamma(z)$$

where $\Gamma_\gamma$ is the stabilizer of $\gamma$ in $M$.

In the case of the horocycle flow on the upper half plane, the orbits are circles tangent to the imaginary axis and perpendicular to all vertical lines. The area of the orbit is infinite, but the invariant measure $\mu_\gamma$ is finite and can be expressed as

$$d\mu_\gamma(z) = \frac{dx dy}{y^2}$$

where $z=x+iy$ and $x, y\in\mathbb{R}$.

The geometric side of the trace formula sums over the orbits of the horocycle flow determined by the non-trivial elements of the modular group $M$, and thus gives a geometric interpretation to the spectral decomposition of the Laplacian operator on the space of automorphic forms. The geometric side of the trace formula measures the amount of spectral mass associated with the horocyclic orbits in the space of automorphic forms, and thus provides information about the distribution of eigenvalues and eigenfunctions.

## How to use this trace formula to prove horocycle flow on the upper half plane is ergodic?

To prove the ergodicity of the horocycle flow on the upper half plane using the trace formula, we need to show that the geometric side of the trace formula determines the spectral decomposition uniquely, up to a set of spectral parameters of measure zero.

Suppose that the horocycle flow on the upper half plane is not ergodic, so that there exists a non-zero function $f$ in the space of automorphic forms that is invariant under the flow. Then, by the Poisson summation formula, we have

$$\sum_{\gamma\in M\backslash\{1\}} \int_{\Gamma_\gamma\backslash\mathbb{H}} f(z) d\mu_\gamma(z) = \sum_{j=1}^\infty m_j \cdot \mathrm{Tr}(f|_{\mathcal{H}_j})$$

where $\mathrm{Tr}(f|_{\mathcal{H}_j})$ is the trace of the restriction of $f$ to the subspace of holomorphic cusp forms of weight $k_j$, and $m_j$ is the multiplicity of the eigenvalue $k_j^2/4$ of the Laplacian operator on $\mathcal{H}_j$.

Since $f$ is invariant under the horocycle flow, it must be constant along each horocycle orbit, and thus each orbit contributes the same amount to the left-hand side of the trace formula. Therefore, we have

$$\int_{\Gamma_\gamma\backslash\mathbb{H}} f(z) d\mu_\gamma(z) = C$$

for all non-trivial elements $\gamma\in M$, where $C$ is a constant. Substituting this into the trace formula, we obtain

$$\sum_{j=1}^\infty m_j \cdot \mathrm{Tr}(f|_{\mathcal{H}_j}) = C\cdot \sum_{\gamma\in M\backslash\{1\}} \int_{\Gamma_\gamma\backslash\mathbb{H}} d\mu_\gamma(z) = \infty$$

since the area of each horocycle orbit is infinite. This contradicts the fact that $f$ is in the space of automorphic forms, and thus proves the ergodicity of the horocycle flow on the upper half plane.

## How to use this trace formula to prove horocycle flow on the upper half plane is mixing?

To use the trace formula to prove that the horocycle flow is mixing, we first define what is meant by mixing.

A dynamical system $(X,\mathcal{B},\mu,T)$ is said to be mixing with respect to a measure preserving transformation $T$ if for any two measurable sets $A,B\in\mathcal{B}$, we have:

$$\lim_{n\rightarrow\infty}\mu(T^{-n}(A)\cap B)=\mu(A)\mu(B)$$

which means that the joint distribution of points in $A$ and $B$ converges to the product of their individual distributions under the action of $T$.

To prove that the horocycle flow is mixing, we use the trace formula to show that the eigenvalues $l_n$ of $H_t$ go to infinity as $n\rightarrow\infty$. This implies that the eigenfunctions corresponding to these eigenvalues become increasingly oscillatory and therefore mix the dynamics of the system.

More formally, let $f,g\in L^2(H,d\mu)$ be two orthogonal functions, and let $\widehat{f}(l),\widehat{g}(l)$ denote their Fourier coefficients with respect to the spectrum of $H_t$. Then, we have:

$$\frac{1}{\text{Vol}(H)}\int_{H}f(p)g(H_t^{-n}p)d\mu(p)=\sum_{l} \widehat{f}(l)\overline{\widehat{g}(l)}e^{tnl}$$

where the sum is over all eigenvalues $l$ of $H_t$.

Using the trace formula, we know that the eigenvalues grow to infinity as $n\rightarrow\infty$, which implies that the summands decay as $n$ tends to infinity. Therefore, the above expression converges to zero as $n$ tends to infinity, which implies that the horocycle flow is mixing.

Therefore, we have shown that the mixing property of the horocycle flow is related to the asymptotic behavior of the eigenvalues and eigenfunctions of the horocycle flow operator, as described by the Selberg trace formula.

## Clearify the detail of the proof

To prove that the horocycle flow is mixing, we can use the Selberg trace formula for the horocycle flow operator, which expresses the trace of the operator as an integral over the length spectrum of horocycles on the hyperbolic plane.

Let $f,g\in L^2(H,d\mu)$ be two orthogonal functions. Then, we have:

$$\begin{aligned}\frac{1}{\text{Vol}(H)}\int_{H}f(p)g(H_t^{-n}p)d\mu(p)&=\frac{1}{\text{Vol}(H)}\int_{H}(H_{t}^{n}f)(p)(H_{t}^{-n}g)(p)\ d\mu(p) \\&= \frac{1}{\text{Vol}(H)}\int_{H}(H_{t}^{n}f)(p)\cdot(H_{t}^{n}\overline{g})(p)\ d\mu(p) \\ &=\sum_{l} e^{tnl}\int_{H}f_{l}(p)\overline{g_{l}(p)}\ d\mu(p) \end{aligned}$$

where $f_l,g_l$ are the Fourier coefficients of $f$ and $g$ with respect to the eigenfunctions of $H_t$ corresponding to eigenvalues $l$.

We note that since $f,g$ are orthogonal, the inner product $\int_H f_l(p)\overline{g_l(p)}d\mu(p)$ is zero unless $f$ and $g$ correspond to the same eigenvalue $l$.

Substituting the expression for the kernel from the Selberg trace formula, we have:

$$\frac{1}{\text{Vol}(H)}\int_{H}f(p)g(H_t^{-n}p)d\mu(p) =\sum_{l} \widehat{f}(l)\overline{\widehat{g}(l)}\int_{0}^\infty e^{-tnl}\ d\lambda_0(l)$$

where $d\lambda_0$ is the normalized measure on the space of horocycles of length $l$.

To prove mixing, we need to show that the above expression converges to zero as $n$ tends to infinity. To do this, we use the fact that the eigenvalues $l_n$ of $H_t$ grow to infinity as $n$ tends to infinity. This implies that the integral $\int_{0}^\infty e^{-tnl}\ d\lambda_0(l)$ decays exponentially as $n$ tends to infinity, which, in turn, implies that the sum over $l$ also decays exponentially.

Therefore, as $n$ tends to infinity, the orthogonal functions $f$ and $g$ converge to zero, which means that the joint distribution of points in $A$ and $B$ (where $A$ and $B$ are any two measurable sets) converges to the product of their individual distributions under the action of the horocycle flow. This proves that the horocycle flow is mixing, as desired.

## How to prove it's unique ergodic by trace formula

To prove that the horocycle flow is uniquely ergodic using the trace formula, we need to show that the horocycle flow operator $H_t$ has only one eigenvector up to scaling.

Suppose that $f$ and $g$ are two eigenfunctions of the horocycle flow operator $H_t$ corresponding to the same eigenvalue $\lambda$, i.e., $H_t(f) = \lambda f$ and $H_t(g) = \lambda g$. Then, we have:

$$\int_H \overline{f(p)}g(q) d\mu(p) = \int_H \overline{f(H_t^{-t}p)}g(H_t^{-t}q) d\mu(p)$$

where the integral is over the hyperbolic plane $H$ and $t$ is any fixed time.

Substituting the expression for the kernel from the Selberg trace formula, we have:

$$\int_H \overline{f(p)}g(q) d\mu(p) = \sum_{n} e^{-t\lambda_n} \int_H \overline{f_n(p)}g_n(q) d\mu(p)$$

where $\lambda_n$ are the eigenvalues of $H_t$ and $f_n,g_n$ are the corresponding eigenfunctions.

Since $f$ and $g$ are both eigenfunctions of $H_t$ and $\lambda$ is a simple eigenvalue of $H_t$, we have $f_n = g_n$ except possibly for a multiplicative constant. Therefore, we have:

$$\int_H \overline{f(p)}g(q) d\mu(p) = C \sum_{n} e^{-t\lambda_n} \int_H |\phi_n(p)|^2 d\mu(p)$$

where $C$ is the normalization constant such that $\int_H |f(p)|^2 d\mu(p) = \int_H |g(p)|^2 d\mu(p) = 1$.

Since $\lambda_n$ grow to infinity as $n$ tends to infinity by the Selberg trace formula, the series on the right-hand side converges to zero as $t$ tends to infinity. Therefore, $\int_H \overline{f(p)}g(q) d\mu(p)$ also converges to zero as $t$ tends to infinity.

Now, if we take $g$ to be the complex conjugate of $f$, then we have:

$$\int_H |f(p)|^2 d\mu(p) = \int_H |g(p)|^2 d\mu(p) = 1$$

and

$$\int_H |\overline{f(p)} f(q)| d\mu(p) = \int_H |f(p)|^2 d\mu(p)$$

Therefore, we can apply the above result to obtain:

$$\int_H \overline{f(p)} f(q) d\mu(p) \rightarrow 0 \text{ as } t\rightarrow\infty$$

This means that as $t$ tends to infinity, $f$ becomes orthogonal to any eigenfunction of $H_t$ corresponding to a non-zero eigenvalue. By the completeness of the set of eigenfunctions, this implies that $f$ is a scalar multiple of the unique eigenfunction of $H_t$ corresponding to the eigenvalue $0$. Therefore, $H_t$ has exactly one eigenfunction up to scaling corresponding to the eigenvalue $0$, which implies that the horocycle flow is uniquely ergodic.

Therefore, we have shown that the unique ergodicity of the horocycle flow can be proved using the Selberg trace formula by showing the existence of only one eigenfunction of the horocycle flow operator corresponding to the eigenvalue $0$, up to scaling.

## What will happen if the hyperbolic plane is non-compact?

If the hyperbolic plane is non-compact, then the spectrum of the horocycle flow operator $H_t$ will not be discrete as in the compact case. Instead, the spectrum will be continuous, i.e., the lengths of the horocycles will form a continuous spectrum rather than a discrete set of eigenvalues.

In this case, the Selberg trace formula for the horocycle flow operator takes a different form. Instead of an infinite sum over the eigenvalues, the trace formula involves an integral over the continuous spectrum. Specifically, we have:

$$\text{Tr}(H_t)=\int_{0}^\infty \frac{1}{2\pi} \text{Tr}(e^{-tl})\frac{dl}{l^2}$$

where $l$ is the length of a horocycle, $\text{Tr}$ denotes the trace, and $d\mu$ is the normalized invariant measure on the space of horocycles with length $l$. The integral is over the continuous spectrum, with the factor $1/l^2$ accounting for the non-compactness of the hyperbolic plane.

Using the trace formula, we can still study the dynamics of the horocycle flow operator and its mixing properties. However, the relationship between the eigenvalues, eigenfunctions and mixing properties in the non-compact case is more complicated than in the compact case. In particular, the horocycle flow on a non-compact hyperbolic plane is not necessarily mixing, and in fact may exhibit a variety of dynamical behaviors such as zero entropy, weak mixing, non-mixing, and measure contraction. The detailed study of the non-compact case requires specialized techniques from dynamical systems theory and harmonic analysis.